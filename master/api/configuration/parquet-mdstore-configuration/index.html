<!--
 -- Copyright 2021 IBM Corp.
 -- SPDX-License-Identifier: Apache-2.0
 -->

<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Extensible Data Skipping Framework for Apache Spark">
      
      
      
        <meta name="author" content="Xskipper team">
      
      
        <link rel="canonical" href="https://xskipper.io/master/api/configuration/parquet-mdstore-configuration/">
      
      <link rel="icon" href="../../../img/logo_black.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.3.1">
    
    
      
        <title>Parquet Metadatastore Configuration - Xskipper</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.1c75ef36.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="#7e56c2">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="deep-purple" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL("../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#parquet-metadatastore-properties" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Xskipper" class="md-header__button md-logo" aria-label="Xskipper" data-md-component="logo">
      
  <img src="../../../img/logo_white.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Xskipper
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Parquet Metadatastore Configuration
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/xskipper-io/xskipper" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    xskipper-io/xskipper
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../.." class="md-tabs__link">
      About
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../getting-started/quick-start-guide/" class="md-tabs__link">
        Getting Started
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../concepts/data-skipping/" class="md-tabs__link">
        Concepts
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../indexing/" class="md-tabs__link md-tabs__link--active">
        API
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="https://github.com/xskipper-io/xskipper/releases" class="md-tabs__link">
      Releases
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Xskipper" class="md-nav__button md-logo" aria-label="Xskipper" data-md-component="logo">
      
  <img src="../../../img/logo_white.png" alt="logo">

    </a>
    Xskipper
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/xskipper-io/xskipper" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    xskipper-io/xskipper
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        About
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Getting Started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Getting Started" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting-started/quick-start-guide/" class="md-nav__link">
        Quick Start Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting-started/sample-notebooks/" class="md-nav__link">
        Demo Notebooks
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Concepts
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Concepts" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Concepts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/data-skipping/" class="md-nav__link">
        Data Skipping
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/extensible/" class="md-nav__link">
        Extensible Data Skipping
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/indexing-flow/" class="md-nav__link">
        Indexing Flow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/query-evaluation-flow/" class="md-nav__link">
        Query Evaluation Flow
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../indexing/" class="md-nav__link">
        Indexing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../creating-new-plugin/" class="md-nav__link">
        Using The Extensible API
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3" type="checkbox" id="__nav_4_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4_3">
          Configuration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Configuration" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          Configuration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/" class="md-nav__link">
        Xskipper Configuration
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Parquet Metadatastore Configuration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Parquet Metadatastore Configuration
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#types-of-metadata-location" class="md-nav__link">
    Types of metadata location
  </a>
  
    <nav class="md-nav" aria-label="Types of metadata location">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#setting-base-location-for-metadata-recommended" class="md-nav__link">
    Setting base location for metadata (recommended)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setting-an-explicit-metadata-location-for-xskipper-instance" class="md-nav__link">
    Setting an explicit metadata location for Xskipper instance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metadata-path-resolving" class="md-nav__link">
    Metadata path resolving
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/" class="md-nav__link">
        API Reference
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_5" type="checkbox" id="__nav_4_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_5">
          Developer Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Developer Guide" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_5">
          <span class="md-nav__icon md-icon"></span>
          Developer Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../developer/build/" class="md-nav__link">
        Build
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../developer/parquet-metadatastore-spec/" class="md-nav__link">
        Parquet metadatastore spec
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../developer/metadata-versioning/" class="md-nav__link">
        Metadata versioning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../developer/generate-doc/" class="md-nav__link">
        API Doc Generation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/xskipper-io/xskipper/blob/master/CONTRIBUTING.md" class="md-nav__link">
        Contributing
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/xskipper-io/xskipper/releases" class="md-nav__link">
        Releases
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <!--
 -- Copyright 2021 IBM Corp.
 -- SPDX-License-Identifier: Apache-2.0
 -->

<h1 id="parquet-metadatastore-properties">Parquet Metadatastore properties<a class="headerlink" href="#parquet-metadatastore-properties" title="Permanent link">&para;</a></h1>
<p>Xskipper uses Parquet as the metadatastore.<br />
The Parquet metadatastore store the metadata for the objects as rows in parquet file. See <a href="../../developer/parquet-metadatastore-spec/">here</a> for more details.</p>
<p>The following are parameters relevant for the Parquet metadatastore.  </p>
<p>These parameters can be set as:</p>
<ul>
<li>JVM wide configuration as described <a href="../configuration/#setting-jvm-wide-configuration">here</a>.</li>
<li>Specific Xskipper instance as described <a href="../configuration/#setting-configuration-for-a-specific-xskipper-instance">here</a>.</li>
</ul>
<table>
<thead>
<tr>
<th>Property</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>io.xskipper.parquet<br/>.mdlocation</td>
<td>N/A</td>
<td>The metadata location according to the type</td>
</tr>
<tr>
<td>io.xskipper.parquet<br/>.mdlocation.type</td>
<td>EXPLICIT_BASE_PATH_LOCATION</td>
<td>See <a href="#types-of-metadata-location">here</a></td>
</tr>
<tr>
<td>io.xskipper.parquet<br/>.index.chunksize</td>
<td>25000</td>
<td>The number of objects to index in each chunk</td>
</tr>
<tr>
<td>io.xskipper.parquet<br/>.maxRecordsPerMetadataFile</td>
<td>50000</td>
<td>The number of records per metadata file used in the compact stage to limit the number of records for small sized metadata files.</td>
</tr>
<tr>
<td>io.xskipper.parquet<br/>.maxMetadataFileSize</td>
<td>33554432 (32MB)</td>
<td>The expected max size of each metadata file will be used by the compact function to distribute the data to multiple files to distribute the data to multiple files in such way that each is less than the expected max size of each metadata file used in conjunction with the max records per file configuration</td>
</tr>
<tr>
<td>io.xskipper.parquet<br/>.encryption.plaintext.footer</td>
<td>false</td>
<td>Whether or not to use plain footer</td>
</tr>
<tr>
<td>io.xskipper.parquet<br/>.encryption.footer.key</td>
<td>N/A</td>
<td>The encryption key that will be used to encrypt the metadata footer</td>
</tr>
<tr>
<td>io.xskipper.parquet<br/>.refresh.dedup</td>
<td>true</td>
<td>When set to true each refresh operation will drop duplicates metadata entries (which might exist due to failed refresh operations)</td>
</tr>
<tr>
<td>io.xskipper.parquet<br/>.filter.dedup</td>
<td>false</td>
<td>When set to true duplicate metadata entries (which might exist due to failed refresh operations) will be dropped when filtering in query run time</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Deduplication during filtering is documented as <code>false</code> by default, but in version <code>1.2.3</code> it accidentally defaults to <code>true</code>.
this cannot affect query results, but may degrade performance.
as a workaround, it can be manually set <code>io.xskipper.parquet.filter.dedup</code> to <code>false</code>.</p>
</div>
<h2 id="types-of-metadata-location">Types of metadata location<a class="headerlink" href="#types-of-metadata-location" title="Permanent link">&para;</a></h2>
<p>The parquet metadatastore looks up the metadata location according to the paramater <code>io.xskipper.parquet.mdlocation</code>, this parameter  is interpreted according to the URL type defined in the parameter <code>io.xskipper.parquet.mdlocation.type</code>.  </p>
<p>The following options are available for the parameter <code>io.xskipper.parquet.mdlocation.type</code>:</p>
<ul>
<li><code>EXPLICIT_BASE_PATH_LOCATION</code>: This is the default. An explicit definition of the base path to the metadata, which is combined with a data set identifier. This case can be used to configure the Xskipper JVM wide settings and have all of data sets metadata saved under the base path.</li>
<li><code>EXPLICIT_LOCATION</code>: An explicit full path to the metadata.</li>
<li><code>HIVE_TABLE_NAME</code>: The name of the Hive table (in the form of <code>&lt;db&gt;.&lt;table&gt;</code>) that contains the exact path of the metadata in the table properties under the parameter <code>io.xskipper.parquet.mdlocation</code>.</li>
<li><code>HIVE_DB_NAME</code>: The name of the Hive database that contains the base path of the metadata in the database properties under the parameter <code>io.xskipper.parquet.mdlocation</code>.</li>
</ul>
<p>For more information on how the metadata path is resolved see <a href="#metadata-path-resolving">here</a>.</p>
<p>You should set the <code>io.xskipper.parquet.mdlocation</code> in one of two ways:</p>
<h3 id="setting-base-location-for-metadata-recommended">Setting base location for metadata (recommended)<a class="headerlink" href="#setting-base-location-for-metadata-recommended" title="Permanent link">&para;</a></h3>
<p>This configuration is useful for setting base location once for all datasets and should be used with the <code>EXPLICIT_BASE_PATH_LOCATION</code> or <code>HIVE_DB_NAME</code> types.</p>
<p>The location of the metadata for each data set will be inferred automatically by combining the base path with a data set identifier.</p>
<p>For example, setting <code>EXPLICIT_BASE_PATH_LOCATION</code>:</p>
<div class="tabbed-set" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><label for="__tabbed_1_1">Python</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">xskipper</span> <span class="kn">import</span> <span class="n">Xskipper</span>

<span class="c1"># The base location to store all indexes </span>
<span class="c1"># TODO: change to your index base location</span>
<span class="n">md_base_location</span> <span class="o">=</span> <span class="s2">&quot;/tmp/metadata&quot;</span>

<span class="c1"># Configuring the JVM wide parameters</span>
<span class="n">conf</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([</span>
            <span class="p">(</span><span class="s2">&quot;io.xskipper.parquet.mdlocation&quot;</span><span class="p">,</span> <span class="n">md_base_location</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;io.xskipper.parquet.mdlocation.type&quot;</span><span class="p">,</span> <span class="s2">&quot;EXPLICIT_BASE_PATH_LOCATION&quot;</span><span class="p">)])</span>
<span class="n">Xskipper</span><span class="o">.</span><span class="n">setConf</span><span class="p">(</span><span class="n">spark</span><span class="p">,</span> <span class="n">conf</span><span class="p">)</span>
</code></pre></div>
</div>
<input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><label for="__tabbed_1_2">Scala</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">from</span> <span class="n">xskipper</span> <span class="k">import</span> <span class="nc">Xskipper</span>

<span class="n">#</span> <span class="nc">The</span> <span class="n">base</span> <span class="n">location</span> <span class="n">to</span> <span class="n">store</span> <span class="n">all</span> <span class="n">indexes</span> 
<span class="n">#</span> <span class="nc">TODO</span><span class="p">:</span> <span class="n">change</span> <span class="n">to</span> <span class="n">your</span> <span class="n">index</span> <span class="n">base</span> <span class="n">location</span>
<span class="n">md_base_location</span> <span class="o">=</span> <span class="s">&quot;/tmp/metadata&quot;</span>

<span class="n">#</span> <span class="nc">Configuring</span> <span class="n">the</span> <span class="nc">JVM</span> <span class="n">wide</span> <span class="n">parameters</span>
<span class="n">conf</span> <span class="o">=</span> <span class="n">dict</span><span class="p">([</span>
            <span class="p">(</span><span class="s">&quot;io.xskipper.parquet.mdlocation&quot;</span><span class="p">,</span> <span class="n">md_base_location</span><span class="p">),</span>
            <span class="p">(</span><span class="s">&quot;io.xskipper.parquet.mdlocation.type&quot;</span><span class="p">,</span> <span class="s">&quot;EXPLICIT_BASE_PATH_LOCATION&quot;</span><span class="p">)])</span>
<span class="nc">Xskipper</span><span class="p">.</span><span class="n">setConf</span><span class="p">(</span><span class="n">spark</span><span class="p">,</span> <span class="n">conf</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<h3 id="setting-an-explicit-metadata-location-for-xskipper-instance">Setting an explicit metadata location for Xskipper instance<a class="headerlink" href="#setting-an-explicit-metadata-location-for-xskipper-instance" title="Permanent link">&para;</a></h3>
<p>This configuration is useful for setting a specific metadata location for a certain data set and should be used with the <code>EXPLICIT_LOCATION</code> or <code>HIVE_TABLE_NAME</code> type.<br />
  You can also set it to <code>EXPLICIT_BASE_PATH_LOCATION</code> or <code>HIVE_DB_NAME</code> if you want to override the JVM defaults. </p>
<p>For example setting an <code>EXPLICIT_LOCATION</code> for xskipper instance:</p>
<div class="tabbed-set" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><label for="__tabbed_2_1">Python</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">xskipper</span> <span class="o">=</span> <span class="n">Xskipper</span><span class="p">(</span><span class="n">spark_session</span><span class="p">,</span> <span class="n">dataset_location</span><span class="p">)</span>

<span class="c1"># call set params to make sure it overwrites JVM wide config</span>
<span class="n">params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;io.xskipper.parquet.mdlocation&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;your metadata&gt;&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;io.xskipper.parquet.mdlocation.type&#39;</span><span class="p">,</span> <span class="s1">&#39;EXPLICIT_BASE_PATH_LOCATION&#39;</span><span class="p">)])</span>
<span class="n">xskipper</span><span class="o">.</span><span class="n">setParams</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</code></pre></div>
</div>
<input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><label for="__tabbed_2_2">Scala</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="kd">val</span> <span class="n">xskipper</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Xskipper</span><span class="p">(</span><span class="n">spark</span><span class="p">,</span> <span class="n">dataset_location</span><span class="p">)</span>

<span class="c1">// call set params to make sure it overwrites JVM wide config</span>
<span class="kd">val</span> <span class="n">params</span> <span class="o">=</span> <span class="nc">Map</span><span class="p">(</span>
  <span class="s">&quot;io.xskipper.parquet.mdlocation&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;&lt;your metadata&gt;&quot;</span><span class="p">,</span>
  <span class="s">&quot;io.xskipper.parquet.mdlocation.type&quot;</span> <span class="o">-&gt;</span>  <span class="s">&quot;EXPLICIT_BASE_PATH_LOCATION&quot;</span><span class="p">)</span>
<span class="n">xskipper</span><span class="p">.</span><span class="n">setParams</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p><br/>
  Note that when setting the type to <code>HIVE_TABLE_NAME</code> you should first set the parameter <code>io.xskipper.parquet.mdlocation</code> in the table properties to point to the metadata location.  </p>
<p>You can the set the metadata location for hive table manually using the following DDL:
    <div class="highlight"><pre><span></span><code><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">myDb</span><span class="p">.</span><span class="n">myTable</span>
<span class="k">SET</span> <span class="n">TBLPROPERTIES</span> <span class="p">(</span><span class="s1">&#39;io.xskipper.parquet.mdlocation&#39;</span><span class="o">=</span><span class="s1">&#39;/location/of/metadata&#39;</span><span class="p">)</span>
</code></pre></div></p>
<p>If the location does not exist in the Hive table, xskipper will try to look up the parameter <code>io.xskipper.parquet.mdlocation</code> in the table's database and treat it as a base path location.</p>
<p>When using <code>HIVE_TABLE_NAME</code> as the location type once indexing is done the parameter <code>io.xskipper.parquet.mdlocation</code> is set in the table properties.<br />
  (in case a fallback to the database base path occured then the resolved path from using the database metadata location as base path is stored in the table properties)</p>
<h3 id="metadata-path-resolving">Metadata path resolving<a class="headerlink" href="#metadata-path-resolving" title="Permanent link">&para;</a></h3>
<p>The following explains how the metadata path is resolved:</p>
<ul>
<li>
<p>During Indexing the metadata location is inferred according to the parameters parameters <code>io.xskipper.parquet.mdlocation</code> and <code>io.xskipper.parquet.mdlocation.type</code> which are set on the xskipper instance.<br />
These parameters are the default JVM wide parameters unless set differently for the given instance.</p>
</li>
<li>
<p>During query run time, the metadata location is inferred according to the following</p>
<ul>
<li>
<p>If there is an active xskipper instance in the JVM for the dataset/table use it's metadata configuration. Otherwise: </p>
</li>
<li>
<p>For Datasets:</p>
<ul>
<li>Look up the parameters <code>io.xskipper.parquet.mdlocation</code> and <code>io.xskipper.parquet.mdlocation.type</code> in the JVM wide configuration in order to infer the metadata location.</li>
</ul>
</li>
<li>
<p>For Hive tables (with partitions<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup>):</p>
<ul>
<li>If the table contains the parameter <code>io.xskipper.parquet.mdlocation</code> use it as the metadata location.</li>
<li>If not, look up the parameter <code>io.xskipper.parquet.mdlocation</code> in the table's database and treat it as a base path location.</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>To index tables without partitions, index the physical location directly.&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../configuration/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Xskipper Configuration" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Xskipper Configuration
            </div>
          </div>
        </a>
      
      
        
        <a href="../../api-reference/" class="md-footer__link md-footer__link--next" aria-label="Next: API Reference" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              API Reference
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            @ 2020 Xskipper.
          </div>
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/xskipper-io" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "toc.integrate"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../assets/javascripts/workers/search.e99e714c.min.js", "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.c7d1b464.min.js"></script>
      
        <script src="../../../javascripts/config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>